<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>åª½å’ªç”Ÿå­˜æ„å¿—æ‰­è›‹æ©Ÿ</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
      /* ä¸€äº›åŸºæœ¬å‹•ç•«è¨­å®š */
      @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
      .animate-in { animation: fade-in 0.5s ease-out; }
    </style>
  </head>
  <body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useMemo, useRef } = React;

      // --- åœ–ç¤ºçµ„ä»¶ ---
      const Icon = ({ path, color = "currentColor", size = 24, className = "" }) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width={size}
          height={size}
          viewBox="0 0 24 24"
          fill="none"
          stroke={color}
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          {path}
        </svg>
      );

      const Icons = {
        Brain: props => (
          <Icon
            {...props}
            path={
              <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 4.44-4zM14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-4.44-4z" />
            }
          />
        ),
        Heart: props => (
          <Icon
            {...props}
            path={
              <path d="M19 14c1.49-1.28 3.6-2.93 3.33-5.38-.13-1.15-.84-2.14-1.99-2.61-2.02-.82-4.38.74-5.84 2.5C13.04 6.75 10.68 5.19 8.66 6.01 7.51 6.48 6.8 7.47 6.67 8.62c-.27 2.45 1.84 4.1 3.33 5.38 2.65 2.29 4.8 4.3 6.94 6.78 2.15-2.48 4.3-4.5 6.94-6.78z" />
            }
          />
        ),
        Activity: props => (
          <Icon
            {...props}
            path={<polyline points="22 12 18 12 15 21 9 3 6 12 2 12" />}
          />
        ),
        Eye: props => (
          <Icon
            {...props}
            path={
              <>
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                <circle cx="12" cy="12" r="3" />
              </>
            }
          />
        ),
        Shield: props => (
          <Icon
            {...props}
            path={<path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />}
          />
        ),
        Wine: props => (
          <Icon
            {...props}
            path={
              <>
                <path d="M8 22h8" />
                <path d="M7 10h10" />
                <path d="M12 15v7" />
                <path d="M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5z" />
              </>
            }
          />
        ),
        Shuffle: props => (
          <Icon
            {...props}
            path={
              <>
                <polyline points="16 3 21 3 21 8" />
                <line x1="4" y1="20" x2="21" y2="3" />
                <polyline points="21 16 21 21 16 21" />
                <line x1="15" y1="15" x2="21" y2="21" />
                <line x1="4" y1="4" x2="9" y2="9" />
              </>
            }
          />
        ),
        RefreshCw: props => (
          <Icon
            {...props}
            path={
              <>
                <path d="M23 4v6h-6" />
                <path d="M1 20v-6h6" />
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15" />
              </>
            }
          />
        ),
        ChevronRight: props => (
          <Icon {...props} path={<polyline points="9 18 15 12 9 6" />} />
        ),
        Play: props => (
          <Icon {...props} path={<polygon points="5 3 19 12 5 21 5 3" />} />
        ),
        Upload: props => (
          <Icon
            {...props}
            path={
              <>
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="17 8 12 3 7 8" />
                <line x1="12" y1="3" x2="12" y2="15" />
              </>
            }
          />
        ),
        Share: props => (
          <Icon
            {...props}
            path={
              <>
                <circle cx="18" cy="5" r="3" />
                <circle cx="6" cy="12" r="3" />
                <circle cx="18" cy="19" r="3" />
                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49" />
                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49" />
              </>
            }
          />
        ),
      };

      function App() {
        const [step, setStep] = useState(0);
        const [selectedChild, setSelectedChild] = useState(null);
        const [selectedState, setSelectedState] = useState(null);
        const [currentTip, setCurrentTip] = useState(null);
        const [isAnimating, setIsAnimating] = useState(false);
        const [displayedChecks, setDisplayedChecks] = useState({
          body: [],
          emotion: [],
          brain: [],
        });
        const [checkedCount, setCheckedCount] = useState(0);
        const [showToast, setShowToast] = useState(false);

        // --- åœ–ç‰‡è¨­å®š (å·²æ›´æ–°ç‚ºæ‚¨çš„æ–°é€£çµ) ---
        const stableDriveLink = "https://i.postimg.cc/T1Rx3Z8q/IMG-7978-(1).jpg";

        const [userImage, setUserImage] = useState(stableDriveLink);
        const fileInputRef = useRef(null);

        // --- è³‡æ–™åº« ---
        const childTypes = [
          { id: 1, name: "å¹•å¾Œé»‘æ‰‹", desc: "å®‰éœä½†çœ¼ç¥éŠ³åˆ©ï¼Œæ„Ÿè¦ºæ­£åœ¨è¨ˆç•«å¦‚ä½•çµ±æ²»å®¶è£¡ã€‚" },
          { id: 2, name: "åè¬å€‹ç‚ºä»€éº¼", desc: "å°æ´—æ¾¡æ²’èˆˆè¶£ï¼Œä½†å°æ°´ç®¡æ§‹é€ å¾ˆæœ‰èˆˆè¶£ï¼ŒæœƒæŠŠå¦³å•å€’ã€‚" },
          { id: 3, name: "ç©¿å°¿å¸ƒçš„æš´å›", desc: "å¤©ç”Ÿçš„è€é—†ï¼Œå‘½ä»¤å¦³æ‹¿ç‰›å¥¶çš„å£æ°£åƒåœ¨å«å·¥è®€ç”Ÿã€‚" },
          { id: 4, name: "é ‚å˜´å¾‹å¸«", desc: "é»‘çš„èƒ½èªªæˆç™½çš„ï¼Œæ˜æ˜æ˜¯ä»–äº‚ç•«ç‰†å£ï¼Œæœ€å¾Œè®Šæˆæ˜¯ç‰†å£çš„éŒ¯ã€‚" },
          { id: 5, name: "è®€å¿ƒè¡“å£«", desc: "çœ¼ç¥æ·±é‚ƒï¼Œå¦³é‚„æ²’ç”Ÿæ°£ä»–å°±å…ˆå“­äº†ï¼Œè®“å¦³ç½ªæƒ¡æ„Ÿçˆ†æ£šã€‚" },
          { id: 6, name: "ç»ç’ƒå¿ƒè©©äºº", desc: "æ´»åœ¨è‡ªå·±çš„å¤¢å¹»æ³¡æ³¡è£¡ï¼Œå«ä»–ç©¿é‹è¦å«åæ¬¡æ‰è½è¦‹ã€‚" },
          { id: 7, name: "é‚ªæ•™æ•™ä¸»", desc: "é­…åŠ›åè¶³ï¼Œå…¨å®¶é•·è¼©éƒ½è¢«ä»–æ”¶è²·ï¼Œåªæœ‰å¦³çŸ¥é“ä»–çš„çœŸé¢ç›®ã€‚" },
          { id: 8, name: "å¤±æ§çš„ç…™ç«", desc: "ç†±æƒ…å¥”æ”¾ï¼Œä¸Šä¸€ç§’å¤§ç¬‘ä¸‹ä¸€ç§’å¤§å“­ï¼Œå®¶è£¡æ°¸é åƒè¢«ç‚¸éã€‚" },
          { id: 9, name: "ç³¾å¯ŸéšŠé•·", desc: "é¤…ä¹¾ä¸€å®šè¦æ“ºæ•´é½Šï¼Œé †åºä¸å°å°±å´©æ½°ï¼Œæ¯”å©†å©†é‚„é›£æã€‚" },
          { id: 10, name: "å¼·åŠ›è† ç„¡å°¾ç†Š", desc: "è¶…ç´šé»äººï¼Œå¦³å»å»æ‰€ä»–ä¹Ÿè¦åœ¨é–€å£å®ˆè­·å¦³ã€‚" },
          { id: 11, name: "é¢¨ç´€è‚¡é•·", desc: "ä¸ä½†ç®¡è‡ªå·±ï¼Œé‚„ç®¡å¦³å¹¾é»ç¡è¦ºã€ç®¡çˆ¸çˆ¸è¥ªå­äº‚ä¸Ÿã€‚" },
          { id: 12, name: "é‡Œé•·ä¼¯", desc: "åªè¦æœ‰äººä¾†å®¶è£¡ä»–å°±äººä¾†ç˜‹ï¼Œä¸ç¡è¦ºä¸€ç›´ç¤¾äº¤ã€‚" },
          { id: 13, name: "ç ´å£ç‹å·¥ç¨‹å¸«", desc: "ç©å…·æ‹¿åˆ°æ‰‹äº”åˆ†é˜å¿…å®šè§£é«”ï¼Œæ“…é•·ç‰©ç†æ”»æ“Šã€‚" },
          { id: 14, name: "é«˜æ•è—è¡“å®¶", desc: "é€™ä»¶è¡£æœä¸ç©¿ã€é‚£å€‹æ¨™ç±¤æœƒåˆºï¼Œæ„Ÿå®˜æ¥µåº¦æ•æ„Ÿã€‚" },
          { id: 15, name: "æ¥µé™é‹å‹•å“¡", desc: "æ²™ç™¼æ˜¯ç”¨ä¾†è·³çš„ï¼Œåœ°æ¿æ˜¯ç”¨ä¾†æ»‘çš„ï¼Œå¦³çš„å¿ƒè‡Ÿæ˜¯ç”¨ä¾†åš‡çš„ã€‚" },
          { id: 16, name: "å¥§æ–¯å¡å½±å¸", desc: "ä¸€é»å°å‚·å£å¯ä»¥æ¼”å¾—åƒæˆªè‚¢ï¼Œæƒ…ç·’å¼µåŠ›æ»¿é»ã€‚" },
        ];

        const momStates = [
          { id: 1, level: "hyper", name: "æ ¸çˆ†ç¾å ´", icon: "ğŸ”¥", desc: "ç†æ™ºç·šå…¨æ–·ï¼Œåªæƒ³æ¯€æ»…ä¸–ç•Œï¼Œèª°ä¾†è¬›è©±éƒ½æƒ³å’¬äººã€‚", color: "bg-red-600 text-white" },
          { id: 2, level: "hyper", name: "æ´»ç«å±±", icon: "ğŸŒ‹", desc: "é‚„æ²’çˆ†ï¼Œä½†é ­é ‚åœ¨å†’ç…™ï¼Œæ‹³é ­ç¡¬ç¡¬çš„ï¼Œéš¨æ™‚æº–å‚™é–‹æˆ°ã€‚", color: "bg-orange-600 text-white" },
          { id: 3, level: "hyper", name: "ç„¦æ…®èœ‚é³¥", icon: "ğŸ", desc: "å¿ƒè·³å¾ˆå¿«ï¼Œä¸€ç›´ç¢ç¢å¿µï¼Œè¦ºå¾—äº‹æƒ…åšä¸å®Œï¼Œåœä¸ä¸‹ä¾†ã€‚", color: "bg-yellow-400 text-yellow-900" },
          { id: 4, level: "optimal", name: "èµ°é‹¼ç´¢çš„äºº", icon: "ğŸ§—", desc: "æ–æ–æ¬²å¢œï¼Œé‚„åœ¨ç¡¬æ’ï¼Œåªè¦å†ä¸€æ¬¡å°–å«å°±æœƒæ‰ä¸‹å»ã€‚", color: "bg-green-400 text-green-900" },
          { id: 5, level: "optimal", name: "ä¿®è¡Œçš„å¸«å§", icon: "ğŸ§˜", desc: "å¿ƒå¦‚æ­¢æ°´(æš«æ™‚)ï¼Œçœ‹ç ´ç´…å¡µï¼Œè¦ºå¾—å­©å­åªæ˜¯ä¾†è¨å‚µçš„ã€‚", color: "bg-green-600 text-white" },
          { id: 6, level: "hypo", name: "è‡ªå‹•å°èˆªæ©Ÿå™¨äºº", icon: "ğŸ¤–", desc: "ç„¡æ„Ÿï¼Œèº«é«”åœ¨å‹•ä½†éˆé­‚ä¸åœ¨ï¼Œæ©Ÿæ¢°å¼åœ°å›æ‡‰ã€Œå–”ã€å¥½ã€ä¸è¡Œã€ã€‚", color: "bg-blue-500 text-white" },
          { id: 7, level: "hypo", name: "èåŒ–çš„å²èŠå§†", icon: "ğŸ« ", desc: "ç„¡åŠ›ï¼Œåªæƒ³èººå¹³ï¼Œåœ°æ¿çœ‹èµ·ä¾†å¥½èˆ’æœï¼Œä¸æƒ³å‹•ä¹Ÿä¸æƒ³èªªè©±ã€‚", color: "bg-indigo-400 text-white" },
          { id: 8, level: "hypo", name: "çµå‡çš„åŒ–çŸ³", icon: "ğŸ—¿", desc: "å¤§è…¦ç•¶æ©Ÿï¼Œå®Œå…¨ç„¡æ³•æ€è€ƒï¼Œçœ‹è‘—å­©å­é¬§ä½†åšä¸å‡ºåæ‡‰ã€‚", color: "bg-gray-600 text-white" },
        ];

        const awarenessChecks = useMemo(
          () => [
            { cat: "body", text: "å¦³çš„è‚©è†€ç¾åœ¨æ˜¯è³èµ·ä¾†çš„å—ï¼Ÿæ”¾ä¸‹å®ƒã€‚" },
            { cat: "body", text: "å¦³çš„ç‰™é—œæ˜¯ä¸æ˜¯å’¬å¾—å¾ˆç·Šï¼ŸæŠŠä¸‹å·´é¬†é–‹ã€‚" },
            { cat: "body", text: "å¦³ç¾åœ¨å‘¼å¸æ˜¯åœæ»¯çš„å—ï¼Ÿåä¸€å£æ°£ã€‚" },
            { cat: "body", text: "å¦³çš„çœ‰é ­æ˜¯ä¸æ˜¯çšºåœ¨ä¸€èµ·ï¼Ÿ" },
            { cat: "body", text: "æ„Ÿè¦ºä¸€ä¸‹è…³åº•è¸©åœ¨åœ°æ¿çš„è§¸æ„Ÿã€‚" },
            { cat: "body", text: "å¦³æ˜¯ä¸æ˜¯å£æ¸´äº†ï¼Ÿé‚„æ˜¯é¤“äº†ï¼Ÿ" },
            { cat: "body", text: "æ‰‹æŒæ˜¯æ¡æ‹³çš„å—ï¼Ÿè©¦è‘—æŠŠæ‰‹æŒ‡å¼µé–‹ã€‚" },
            { cat: "body", text: "ç¾åœ¨çœ¼ç¥æ˜¯èšç„¦çš„ï¼Œé‚„æ˜¯æ•£æ¸™çš„ï¼Ÿ" },
            { cat: "body", text: "èƒƒæ˜¯ä¸æ˜¯è¦ºå¾—ç·Šç·Šçš„ã€æˆ–æ˜¯æƒ³åï¼Ÿ" },
            { cat: "emotion", text: "èƒ¸å£é‚£åœ˜æ‚¶æ‚¶çš„æ„Ÿè¦ºæ˜¯ä»€éº¼é¡è‰²ï¼Ÿ" },
            { cat: "emotion", text: "å¦³ç¾åœ¨è¦ºå¾—å§”å±ˆå—ï¼Ÿ(é‚£å¾ˆæ­£å¸¸)" },
            { cat: "emotion", text: "å¦‚æœæ†¤æ€’æ˜¯ä¸€éš»å‹•ç‰©ï¼Œç¾åœ¨ç‰ é•·ä»€éº¼æ¨£å­ï¼Ÿ" },
            { cat: "emotion", text: "è…¦ä¸­æ˜¯å¦æµ®ç¾ã€Œåªæœ‰æˆ‘åœ¨åŠªåŠ›ã€çš„æ„Ÿè¦ºï¼Ÿ" },
            { cat: "emotion", text: "å…è¨±è‡ªå·±ç¾åœ¨å°±æ˜¯ä¸å–œæ­¡é€™å€‹å­©å­ã€‚" },
            { cat: "emotion", text: "é‚£è‚¡æƒ³å“­çš„æ„Ÿè¦ºï¼Œå¯ä»¥è®“å®ƒæµå‡ºä¾†å—ï¼Ÿ" },
            { cat: "emotion", text: "å¦³ç¾åœ¨æ˜¯æƒ³ã€Œé€ƒè·‘ã€é‚„æ˜¯æƒ³ã€Œæˆ°é¬¥ã€ï¼Ÿ" },
            { cat: "emotion", text: "æ˜¯ä¸æ˜¯è¦ºå¾—è‡ªå·±å¾ˆå­¤å–®ï¼Œæ²’äººæ‡‚å¦³ï¼Ÿ" },
            { cat: "emotion", text: "æ˜¯å¦æœ‰ä¸€ç¨®ã€Œä¸æƒ³ç®¡äº†ã€éš¨ä¾¿å•¦ã€çš„ç„¡åŠ›æ„Ÿï¼Ÿ" },
            { cat: "brain", text: "è…¦ä¸­æ˜¯ä¸æ˜¯åœ¨é‡æ’­ã€Œæˆ‘ä¸æ˜¯å¥½åª½åª½ã€ï¼Ÿ" },
            { cat: "brain", text: "æ“”å¿ƒã€Œå¦‚æœä¸æ•™ä»–ï¼Œä»–ä»¥å¾Œæœƒå®Œè›‹ã€ï¼Ÿ(åŠ‡é€ï¼šä¸æœƒ)" },
            { cat: "brain", text: "å¦³ç¾åœ¨æ€¥è‘—è§£æ±ºå•é¡Œï¼Œé‚„æ˜¯éœ€è¦å…ˆé›¢é–‹ç¾å ´ï¼Ÿ" },
            { cat: "brain", text: "è¦ºå¾—é€™å€‹å´©æ½°æ˜¯ã€Œé‡å°å¦³ã€çš„å—ï¼Ÿ" },
            { cat: "brain", text: "ç¾åœ¨æœ€ç³Ÿç³•çš„ç‹€æ³æ˜¯ä»€éº¼ï¼Ÿå…¶å¯¦å¤§å®¶éƒ½é‚„æ´»è‘—ã€‚" },
            { cat: "brain", text: "è©¦è‘—æŠŠå¿ƒä¸­çš„ã€Œæˆ‘å¿…é ˆã€æ”¹æˆã€Œæˆ‘å¯ä»¥é¸æ“‡ã€ã€‚" },
            { cat: "brain", text: "åœä¸‹ä¾†ï¼Œèªªå‡ºçœ¼å‰ä¸‰å€‹ç‰©å“çš„é¡è‰²ã€‚" },
            { cat: "brain", text: "å¦³ç¾åœ¨çš„å¿µé ­æ˜¯ã€Œäº‹å¯¦ã€ï¼Œé‚„æ˜¯ã€Œæƒ³åƒã€ï¼Ÿ" },
            { cat: "brain", text: "æ˜¯ä¸æ˜¯åœ¨æƒ³ã€Œç‚ºä»€éº¼åˆ¥äººçš„å°å­©éƒ½ä¸æœƒé€™æ¨£ã€ï¼Ÿ" },
          ],
          []
        );

        const survivalTips = [
          "å»å»æ‰€æŠŠé–€é–èµ·ä¾†ï¼Œåè‘—æ»‘æ‰‹æ©Ÿ3åˆ†é˜ï¼Œé€™æ˜¯å¦³çš„ç¥è–æ¬Šåˆ©ã€‚",
          "å–ä¸€æ¯å†°æ°´ã€‚ç‰©ç†é™æº«æœ‰åŠ©æ–¼å¤§è…¦é‡æ–°é–‹æ©Ÿã€‚",
          "æˆ´ä¸Šé™å™ªè€³æ©Ÿã€‚è½ä¸åˆ°å“­è²ï¼Œä¸–ç•Œå°±å’Œå¹³äº†ä¸€åŠã€‚",
          "åƒä¸€é¡†å·§å…‹åŠ›ã€‚å¦‚æœä¸€é¡†ä¸å¤ ï¼Œå°±åƒå…©é¡†ã€‚",
          "ç”¨åŠ›ç”©æ‰‹30ä¸‹ï¼ŒæŠŠæƒ³æ‰“äººçš„èƒ½é‡ç”©å‡ºå»ã€‚",
          "çœ‹è‘—å­©å­å°æ™‚å€™ç¡è¦ºçš„ç…§ç‰‡ï¼Œå‚¬çœ è‡ªå·±ä»–å¾ˆå¯æ„›ã€‚",
          "æƒ³åƒå¦³æ˜¯åœ‹å®¶åœ°ç†é »é“çš„æ”å½±å¸«ï¼Œæ­£åœ¨è§€å¯Ÿä¸€éš»å¤±æ§çš„å¹¼ç¸ã€‚",
          "å°è‘—é¡å­åšé¬¼è‡‰ï¼Œè¶Šé†œè¶Šå¥½ï¼Œé¨™éå¤§è…¦æ”¾é¬†è‡‰éƒ¨è‚Œè‚‰ã€‚",
          "åœ¨å¿ƒè£¡é»˜å¿µå’’èªï¼šã€Œé€™åªæ˜¯éç¨‹ï¼Œä¸æ˜¯çµå±€ã€‚ã€",
          "æ‰“é›»è©±çµ¦æœ€æ‡‚å¦³çš„æœ‹å‹ï¼Œç½µå€‹5åˆ†é˜é«’è©±ã€‚",
          "ä»€éº¼éƒ½ä¸è¦æ•™ã€‚ä»Šå¤©åªè¦ç¢ºä¿å¤§å®¶éƒ½æœ‰å‘¼å¸å°±å¥½ã€‚",
          "é»å¤–é€ã€‚ä»Šå¤©æ™šä¸Šä¸ç…®é£¯äº†ï¼Œæ”¾éè‡ªå·±ã€‚",
          "ç”¨å†·æ°´æ´—è‡‰ï¼Œæ„Ÿå—æ°´çš„æº«åº¦ã€‚",
          "èººåœ¨åœ°æ¿ä¸Šï¼Œå‡è£è‡ªå·±æ˜¯å—å®³è€…ç¾å ´ï¼ˆå­©å­å¯èƒ½æœƒè¢«åš‡åˆ°è€Œå®‰éœï¼‰ã€‚",
          "æ·±å¸æ°£4ç§’ï¼Œæ†‹æ°£4ç§’ï¼Œåæ°£8ç§’ã€‚é‡è¤‡ä¸‰æ¬¡ã€‚",
          "æŠŠé€™ä¸€åˆ‡å¯«ä¸‹ä¾†ï¼ˆæˆ–æ‰“åœ¨æ‰‹æ©Ÿå‚™å¿˜éŒ„ï¼‰ï¼ŒæŠŠè…¦è¢‹è£¡çš„åƒåœ¾å€’å‡ºä¾†ã€‚",
          "å…è¨±é–‹é›»è¦–/å¹³æ¿ä¿æ¯ã€‚30åˆ†é˜çš„å®‰éœæ¯”å …æŒåŸå‰‡æ›´é‡è¦ã€‚",
          "å°å­©å­èªªï¼šã€Œåª½åª½ç¾åœ¨åƒå“¥å‰æ‹‰ä¸€æ¨£ç”Ÿæ°£ï¼Œéœ€è¦æš«åœã€‚ã€ç„¶å¾Œèµ°é–‹ã€‚",
          "èä¸€èå®¶è£¡å¥½èçš„å‘³é“ï¼ˆå’–å•¡ã€ç²¾æ²¹ã€ç”šè‡³æ˜¯æ´—ç¢—ç²¾ï¼‰ã€‚",
          "å»æŠ±ä¸€é¡†æ•é ­ï¼Œç”¨åŠ›æ“ å£“å®ƒã€‚",
          "æƒ³ä¸€ä¸‹é€™ä»¶äº‹äº”å¹´å¾Œé‚„é‡è¦å—ï¼Ÿå¦‚æœä¸é‡è¦ï¼Œå°±éš¨ä¾¿å§ã€‚",
          "æŠŠæ¨™æº–é™ä½ã€‚ä»Šå¤©æœ‰åˆ·ç‰™å°±æ˜¯æ»¿åˆ†ï¼Œæ²’åˆ·ç‰™ä¹Ÿæ­»ä¸äº†ã€‚",
          "å°è‡ªå·±èªªï¼šã€Œæˆ‘ç›¡åŠ›äº†ï¼Œæˆ‘çœŸçš„ç›¡åŠ›äº†ã€‚ã€",
          "æƒ³åƒæœ‰ä¸€å€‹é‡‘è‰²çš„é˜²è­·ç½©ç½©è‘—å¦³ï¼Œå­©å­çš„å°–å«è²å½ˆä¸é€²ä¾†ã€‚",
          "å»é™½å°æˆ–æ˜¯çª—é‚Šï¼Œçœ‹è‘—å¤©ç©ºæˆ–æ˜¯é æ–¹çš„æ¨¹ã€‚",
          "ç”¨æ£‰è¢«æŠŠè‡ªå·±æ²èµ·ä¾†ï¼Œåƒå£½å¸ä¸€æ¨£ï¼ˆåŠ å£“èƒ½å¸¶ä¾†å®‰å…¨æ„Ÿï¼‰ã€‚",
          "å‡è£è‡ªå·±æ˜¯å¤–æ˜Ÿäººï¼Œç¬¬ä¸€æ¬¡ä¾†åˆ°åœ°çƒè§€å¯Ÿäººé¡è‚²å…’ã€‚",
          "å”±ä¸€é¦–å¦³å–œæ­¡çš„æ­Œï¼ˆå¤§è²å”±ï¼‰ï¼Œè“‹éå­©å­çš„å“­è²ã€‚",
          "æŒ‰æ‘©è‡ªå·±çš„è€³æœµï¼Œæˆ–æ˜¯è¼•æ‹è‡ªå·±çš„èƒ¸å£ã€‚",
          "æƒ³ä¸€ä»¶ç­‰ä¸€ä¸‹å­©å­ç¡è‘—å¾Œå¦³è¦åšçˆ½äº‹ï¼ˆè¿½åŠ‡ã€ç¶²è³¼ï¼‰ã€‚",
          "å‘Šè¨´è‡ªå·±ï¼šã€Œä»–çš„å‰é¡è‘‰é‚„æ²’é•·å¥½ï¼Œä»–å°±æ˜¯å€‹åŸå§‹äººã€‚ã€",
          "å–ä¸€æ¯ç†±èŒ¶/ç†±å’–å•¡ï¼Œå°ˆæ³¨åœ¨ååš¥çš„æ„Ÿè¦ºã€‚",
          "æŠŠç‡ˆé—œæš—ä¸€é»ã€‚å¤ªäº®çš„ç’°å¢ƒæœƒå¢åŠ ç„¦æ…®ã€‚",
          "çµ¦å­©å­ä¸€å€‹æ“æŠ±ï¼ˆæœ‰æ™‚å€™é€™èƒ½è®“å½¼æ­¤çš„ç¥ç¶“ç³»çµ±åŒæ­¥å†·éœï¼‰ã€‚",
          "å¦‚æœçœŸçš„å—ä¸äº†ï¼Œå°±è·Ÿè‘—å­©å­ä¸€èµ·å“­ã€‚åš‡åš‡ä»–ä¹Ÿå¥½ã€‚",
          "å»æ´—å€‹ç†±æ°´æ¾¡ï¼Œæƒ³åƒæ°´æµæ²–èµ°èº«ä¸Šçš„è² èƒ½é‡ã€‚",
          "ç«™èµ·ä¾†èµ°å‹•èµ°å‹•ï¼Œä¸è¦ä¸€ç›´åè‘—æˆ–è¹²è‘—ã€‚",
          "æ•¸æ•¸ã€‚å¾100å€’æ•¸å›ä¾†ï¼Œ7å€‹7å€‹æ•¸ï¼ˆ100, 93, 86...ï¼‰å¼·åˆ¶å¤§è…¦åˆ‡æ›ã€‚",
          "æ‰¿èªå¦³ç¾åœ¨å¾ˆè¨å­é€™ä¸€åˆ‡ã€‚é€™ä¸ä»£è¡¨å¦³ä¸æ„›å­©å­ã€‚",
          "æƒ³åƒå¦³æœ€å–œæ­¡çš„å¶åƒæˆ–æ˜¯æ™ºè€…ï¼Œå¦‚æœæ˜¯ä»–æœƒæ€éº¼åšï¼Ÿ",
          "æ‘¸æ‘¸å®¶è£¡çš„å¯µç‰©ï¼Œæˆ–æ˜¯æ‘¸æ‘¸è»Ÿè»Ÿçš„æ¯›æ¯¯ã€‚",
          "æŠŠé€™ç•¶æˆä¸€å€‹ç¬‘è©±ï¼Œæƒ³è‘—ä»¥å¾Œæ€éº¼è·Ÿæœ‹å‹è¬›é€™æ®µè’è¬¬çš„æ•…äº‹ã€‚",
          "æª¢æŸ¥è‡ªå·±æ˜¯ä¸æ˜¯ç”Ÿç†æœŸå¿«ä¾†äº†ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£ä¸€åˆ‡éƒ½åˆç†äº†ã€‚",
          "çµ¦è‡ªå·±è¨­ä¸€å€‹åœæé»ï¼šã€Œå†æ’10åˆ†é˜å°±å¥½ã€‚ã€",
          "å¦‚æœå­©å­åœ¨å®‰å…¨ç¯„åœï¼Œæˆ´ä¸Šè€³å¡ï¼Œç„¡è¦–ä»–10åˆ†é˜ã€‚",
          "å–ä¸€æ¯å«ç³–é£²æ–™ã€‚å»ä»–çš„æ¸›è‚¥ã€‚",
          "åšåå€‹é–‹åˆè·³ã€‚",
          "å°è‡ªå·±èªªï¼šã€Œæˆ‘ä¸éœ€è¦ç•¶å®Œç¾åª½åª½ï¼Œæˆ‘åªè¦ç•¶ã€å¤ å¥½ã€çš„åª½åª½ã€‚ã€",
          "åŸè«’å‰›å‰›å¤±æ§çš„è‡ªå·±ã€‚å¦³ä¹Ÿæ˜¯äººï¼Œä¹Ÿæœƒç´¯ã€‚",
          "å¦‚æœçœŸçš„ä¸è¡Œï¼Œå°‹æ±‚å°ˆæ¥­å”åŠ©æ˜¯å‹‡æ•¢çš„è¡¨ç¾ï¼Œä¸æ˜¯å¤±æ•—ã€‚",
          "æŠŠå­©å­ä¸Ÿçµ¦çˆ¸çˆ¸ï¼ˆæˆ–é›»è¦–ï¼‰ï¼Œé€™å«ã€åˆ†æ•£æŠ•è³‡é¢¨éšªã€ï¼Œä¸è¦æŠŠé›è›‹éƒ½æ”¾åœ¨è‡ªå·±é€™å€‹ç±ƒå­è£¡ã€‚",
          "æƒ³åƒå¦³æ˜¯æ­£åœ¨æ¸¡åŠ«çš„ä¸Šç¥ï¼Œé€™éš»ç¥ç¸æ˜¯ä¾†åŠ©å¦³é£›å‡çš„ã€‚å¿éå»ï¼Œå¦³å°±æˆä»™äº†ã€‚",
          "çœ‹è‘—æ»¿åœ°çš„ç©å…·ï¼Œè·¨éå»å°±å¥½ã€‚é‚£æ˜¯ç•¶ä»£å‰è¡›è£ç½®è—è¡“ï¼Œä¸è¦ç ´å£å®ƒã€‚",
          "å¦‚æœä»Šå¤©å¦³åªå‰©ä¸‹ä¸€å£æ°£ï¼Œå°±ç•™è‘—ç”¨ä¾†å‘¼å¸ï¼Œä¸è¦ç”¨ä¾†ç½µäººã€‚æ´»è‘—æ¯”è¼ƒé‡è¦ã€‚",
          "å¦³çš„åƒ¹å€¼ä¸å–æ±ºæ–¼å®¶è£¡åœ°æ¿çš„ä¹¾æ·¨ç¨‹åº¦ã€‚äº‚å°±äº‚å§ï¼Œåæ­£æ˜å¤©é‚„æ˜¯æœƒäº‚ã€‚",
          "å–ä¸€å£çå¥¶ï¼ˆå…¨ç³–ï¼‰ï¼Œå‘Šè¨´è‡ªå·±é€™æ˜¯ã€æ¶²é«”æŠ—æ†‚é¬±åŠ‘ã€ï¼Œé€™æ˜¯ç‚ºäº†å®¶åº­å’Œè«§è€Œå–ã€‚",
          "ç¾åœ¨é–‰ä¸Šçœ¼ç›ï¼Œæƒ³åƒå¦³åœ¨å¤å¨å¤·æµ·ç˜...å¥½ï¼Œçœé–‹çœ¼ï¼Œç¹¼çºŒæ´—ç¢—ï¼Œè‡³å°‘å¿ƒéˆå·²ç¶“åº¦éå‡äº†ã€‚",
          "æŠŠå¿ƒè£¡çš„ã€æˆ‘æ‡‰è©²ã€å…¨éƒ¨æ”¹æˆã€æˆ‘ä¸çˆ½ã€ï¼Œèª å¯¦é¢å°è‡ªå·±çš„é»‘æš—é¢ï¼Œå¦³æœƒè¦ºå¾—èˆ’å¦å¾ˆå¤šã€‚",
          "å­©å­é‚„æ´»è‘—ï¼Ÿå¦³é‚„æ´»è‘—ï¼Ÿæˆ¿å­æ²’ç‡’æ‰ï¼Ÿæ­å–œï¼ä»Šæ—¥ä»»å‹™åœ“æ»¿é”æˆï¼Œçµ¦è‡ªå·±æŒè²é¼“å‹µã€‚",
          "å°è‘—é¡å­è£¡çš„ç˜‹å©†å­èªªï¼šã€è¾›è‹¦äº†ï¼Œé›–ç„¶å¦³ç¾åœ¨çœ‹èµ·ä¾†å¾ˆç³Ÿï¼Œä½†å…¶å¯¦æŒºå¯æ„›çš„ã€‚ã€",
        ];

        useEffect(() => {
          if (step === 3) {
            shuffleCategory("body");
            shuffleCategory("emotion");
            shuffleCategory("brain");
            setCheckedCount(0);
          }
        }, [step]);

        const shuffleCategory = category => {
          const items = awarenessChecks.filter(x => x.cat === category);
          const shuffled = [...items].sort(() => 0.5 - Math.random());
          const selected = shuffled.slice(0, 3);
          setDisplayedChecks(prev => ({
            ...prev,
            [category]: selected,
          }));
        };

        const handleCheck = e => {
          if (e.target.checked) {
            setCheckedCount(prev => prev + 1);
          } else {
            setCheckedCount(prev => Math.max(0, prev - 1));
          }
        };

        const handleDraw = () => {
          setIsAnimating(true);
          setCurrentTip(null);
          setTimeout(() => {
            const randomTip =
              survivalTips[Math.floor(Math.random() * survivalTips.length)];
            setCurrentTip(randomTip);
            setIsAnimating(false);
          }, 1000);
        };

        const handleImageUpload = e => {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onloadend = () => {
              setUserImage(reader.result);
            };
            reader.readAsDataURL(file);
          }
        };

        const triggerFileInput = () => {
          fileInputRef.current.click();
        };

        const handleShare = async () => {
          const urlToShare = window.location.href;
          const shareData = {
            title: "åª½å’ªç”Ÿå­˜æ„å¿—æ‰­è›‹æ©Ÿ",
            text: "ç»çµ¦æ¯ä¸€å€‹åœ¨å´©æ½°é‚Šç·£è©¦è‘—æ·±å‘¼å¸çš„å¦³ã€‚é€™è£¡ä¸æ•™å¦³æ€éº¼æ•™å°å­©ï¼Œåªæ•™å¦³æ€éº¼æ´»ä¸‹å»ã€‚",
            url: urlToShare,
          };

          try {
            if (navigator.share) {
              await navigator.share(shareData);
              return;
            }
            await navigator.clipboard.writeText(urlToShare);
            setShowToast(true);
            setTimeout(() => setShowToast(false), 2500);
          } catch (err) {
            try {
              const textArea = document.createElement("textarea");
              textArea.value = urlToShare;
              textArea.style.position = "fixed";
              textArea.style.left = "-9999px";
              document.body.appendChild(textArea);
              textArea.focus();
              textArea.select();
              const successful = document.execCommand("copy");
              document.body.removeChild(textArea);

              if (successful) {
                setShowToast(true);
                setTimeout(() => setShowToast(false), 2500);
              } else {
                prompt("è«‹æ‰‹å‹•è¤‡è£½ç¶²å€ï¼š", urlToShare);
              }
            } catch (fallbackErr) {
              prompt("è«‹æ‰‹å‹•è¤‡è£½ç¶²å€ï¼š", urlToShare);
            }
          }
        };

        const renderWelcome = () => (
          <div className="flex flex-col items-center justify-center min-h-[80vh] text-center p-6 animate-in fade-in duration-700">
            <button
              onClick={handleShare}
              className="absolute top-4 right-4 p-2 bg-white/50 rounded-full hover:bg-white transition-colors text-gray-500 hover:text-pink-600"
              title="åˆ†äº«çµ¦æœ‹å‹"
            >
              <Icons.Share size={24} />
            </button>

            <div
              className="relative mb-8 group cursor-pointer"
              onClick={triggerFileInput}
              title="é»æ“Šæ›´æ›å¦³çš„å­ä¸–å¤§é ­è²¼"
            >
              <div className="absolute inset-0 bg-pink-600 rounded-full blur opacity-20 group-hover:opacity-40 transition-opacity animate-pulse"></div>
              <div className="w-40 h-40 rounded-full border-4 border-gray-900 overflow-hidden bg-white relative z-10 shadow-xl transform group-hover:scale-105 transition-transform duration-300">
                <img
                  src={userImage}
                  alt="å­ä¸–åª½å’ªé ­åƒ"
                  className="w-full h-full object-cover"
                  referrerPolicy="no-referrer"
                  onError={e => {
                    e.target.style.display = "none";
                    e.target.parentNode.classList.add("bg-gray-200");
                  }}
                />
                <div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                  <Icons.Upload className="text-white" size={32} />
                </div>
              </div>

              <input
                type="file"
                ref={fileInputRef}
                onChange={handleImageUpload}
                accept="image/*"
                className="hidden"
              />

              <div className="absolute -top-2 -right-6 bg-white border-2 border-gray-900 px-3 py-1 rounded-xl rounded-bl-none z-20 shadow-lg transform rotate-12 animate-bounce">
                <span className="font-bold text-gray-900 font-mono">UGH...</span>
              </div>
            </div>

            <h1 className="text-4xl font-black text-gray-900 mb-4 tracking-tight leading-tight">
              åª½å’ªç”Ÿå­˜æ„å¿—
              <br />
              <span className="text-pink-600 inline-block mt-2">æ‰­è›‹æ©Ÿ</span>
            </h1>

            <div className="w-16 h-1 bg-gray-900 mb-6"></div>

            <p className="text-gray-600 mb-8 max-w-xs leading-relaxed font-medium">
              ç»çµ¦æ¯ä¸€å€‹åœ¨å´©æ½°é‚Šç·£
              <br />
              è©¦è‘—æ·±å‘¼å¸çš„å¦³ã€‚
              <br />
              <br />
              é€™è£¡ä¸æ•™å¦³æ€éº¼æ•™å°å­©ï¼Œ
              <br />
              <span className="text-pink-600 font-bold bg-pink-50 px-1">
                åªæ•™å¦³æ€éº¼æ´»ä¸‹å»ã€‚
              </span>
            </p>

            <button
              onClick={() => {
                setStep(1);
                window.scrollTo(0, 0);
              }}
              className="group relative inline-flex items-center justify-center px-8 py-4 font-bold text-white transition-all duration-200 bg-gray-900 font-lg rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 hover:bg-pink-600 active:scale-95 shadow-xl"
            >
              <span className="mr-2">æŠ•å…¥ç†æ™ºç¡¬å¹£</span>
              <Icons.Play size={20} className="fill-current" />
              <div className="absolute inset-0 rounded-full ring-2 ring-white/20 group-hover:ring-white/40"></div>
            </button>

            <p className="mt-6 text-xs text-gray-400">
              * 100% å¹½é»˜æˆåˆ†ï¼Œä¸å«ä»»ä½•èªªæ•™
            </p>
          </div>
        );

        const renderStep1 = () => (
          <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
            <div className="text-center mb-6">
              <h2 className="text-2xl font-black text-gray-800">Step 1. å°æ‰‹åœ–é‘‘</h2>
              <p className="text-pink-600 font-bold text-sm">
                çŸ¥å·±çŸ¥å½¼ï¼Œä»Šå¤©çš„å­©å­æ˜¯å“ªå€‹å“ç¨®ï¼Ÿ
              </p>
            </div>
            <div className="grid grid-cols-2 gap-3 pb-20">
              {childTypes.map(child => (
                <button
                  key={child.id}
                  onClick={() => {
                    setSelectedChild(child);
                    setStep(2);
                    window.scrollTo(0, 0);
                  }}
                  className="bg-white p-3 rounded-xl border-2 border-gray-100 hover:border-pink-500 hover:bg-pink-50 transition-all text-left shadow-sm relative overflow-hidden group"
                >
                  <div className="font-bold text-gray-800 text-lg mb-1">
                    {child.name}
                  </div>
                  <div className="text-xs text-gray-500 leading-snug">
                    {child.desc}
                  </div>
                  <div className="absolute -right-2 -bottom-2 opacity-5 text-4xl group-hover:opacity-10 transition-opacity text-pink-500">
                    ğŸ‘¾
                  </div>
                </button>
              ))}
            </div>
          </div>
        );

        const renderStep2 = () => (
          <div className="animate-in fade-in slide-in-from-right duration-500">
            <button
              onClick={() => setStep(1)}
              className="text-gray-400 text-sm mb-4 flex items-center hover:text-pink-600 transition-colors"
            >
              â† é‡é¸å°æ‰‹
            </button>
            <div className="bg-gray-900 border-l-4 border-pink-500 p-4 rounded-r-lg mb-6 shadow-md text-white">
              <div className="text-xs text-pink-400 font-bold uppercase">
                Current Enemy
              </div>
              <div className="font-bold text-xl">{selectedChild.name}</div>
              <div className="text-sm text-gray-300">{selectedChild.desc}</div>
            </div>

            <div className="text-center mb-6">
              <h2 className="text-2xl font-black text-gray-800">Step 2. ç½æƒ…è©•ä¼°</h2>
              <p className="text-pink-600 font-bold text-sm">
                èª å¯¦é¢å°ï¼Œå¦³ç¾åœ¨çš„ç†æ™ºç·šç‹€æ³ï¼Ÿ
              </p>
            </div>

            <div className="space-y-3 pb-20">
              {momStates.map(state => (
                <button
                  key={state.id}
                  onClick={() => {
                    setSelectedState(state);
                    setStep(3);
                    window.scrollTo(0, 0);
                  }}
                  className={`w-full p-4 rounded-xl shadow-sm flex items-center gap-4 transition-transform active:scale-95 text-left border-2 border-transparent hover:border-black ${state.color}`}
                >
                  <div className="text-4xl filter drop-shadow-md">{state.icon}</div>
                  <div>
                    <div className="font-bold text-lg">{state.name}</div>
                    <div className="text-xs opacity-90 font-medium">{state.desc}</div>
                  </div>
                </button>
              ))}
            </div>
          </div>
        );

        const renderStep3 = () => (
          <div className="animate-in zoom-in duration-500 min-h-[80vh] flex flex-col">
            <div className="bg-gray-900 text-white p-6 rounded-b-3xl -mx-4 -mt-4 mb-6 shadow-xl relative overflow-hidden">
              <div className="absolute top-0 right-0 w-32 h-32 bg-pink-600 rounded-full blur-3xl opacity-20 -mr-10 -mt-10"></div>
              <div className="relative z-10">
                <div className="flex justify-between items-center mb-4">
                  <h2 className="text-2xl font-bold flex items-center gap-2">
                    <Icons.Activity className="text-pink-400" /> æ©Ÿé«”æƒæ
                  </h2>
                  <span className="text-xs bg-gray-800 border border-gray-700 px-2 py-1 rounded text-pink-300">
                    ç³»çµ±è‡ªæˆ‘ä¿®å¾©ä¸­...
                  </span>
                </div>
                <div className="flex items-start gap-4">
                  <div className="text-5xl">{selectedState.icon}</div>
                  <div>
                    <div className="text-sm opacity-50">ç•¶å‰ç‹€æ…‹</div>
                    <div className="text-xl font-bold text-pink-400">
                      {selectedState.name}
                    </div>
                    <div className="text-sm opacity-75 mt-1">
                      è«‹èŠ± 10 ç§’é˜ï¼Œè§€å¯Ÿè‡ªå·±...
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div className="flex-1 space-y-4 px-2">
              <div className="mb-2 px-1 text-sm text-pink-600 font-bold">
                å‹¾é¸å¦³æœ‰çš„æ„Ÿè¦ºï¼ˆæ²’æœ‰ä¹Ÿå¯ä»¥ç›´æ¥è·³éï¼‰ï¼š
              </div>

              {/* Body */}
              <div className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:border-pink-300 transition-colors">
                <div className="flex justify-between items-center mb-3">
                  <h3 className="font-bold text-gray-800 flex items-center gap-2">
                    <Icons.Eye size={18} className="text-gray-400" /> èº«é«” (Body)
                  </h3>
                  <button
                    onClick={() => shuffleCategory("body")}
                    className="text-xs flex items-center gap-1 text-pink-600 bg-pink-50 px-2 py-1 rounded-full hover:bg-pink-100 transition"
                  >
                    <Icons.Shuffle size={12} /> æ›ä¸€çµ„
                  </button>
                </div>
                <ul className="space-y-3">
                  {displayedChecks.body.map((item, i) => (
                    <label
                      key={i}
                      className="text-gray-600 text-sm flex gap-3 items-start cursor-pointer hover:bg-slate-50 p-1 rounded transition-colors"
                    >
                      <input
                        type="checkbox"
                        onChange={handleCheck}
                        className="mt-1 rounded text-pink-600 focus:ring-pink-600 w-4 h-4 shrink-0 border-gray-300"
                      />
                      <span className="leading-snug">{item.text}</span>
                    </label>
                  ))}
                </ul>
              </div>

              {/* Emotion */}
              <div className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:border-pink-300 transition-colors">
                <div className="flex justify-between items-center mb-3">
                  <h3 className="font-bold text-gray-800 flex items-center gap-2">
                    <Icons.Heart size={18} className="text-gray-400" /> æƒ…ç·’ (Emotion)
                  </h3>
                  <button
                    onClick={() => shuffleCategory("emotion")}
                    className="text-xs flex items-center gap-1 text-pink-600 bg-pink-50 px-2 py-1 rounded-full hover:bg-pink-100 transition"
                  >
                    <Icons.Shuffle size={12} /> æ›ä¸€çµ„
                  </button>
                </div>
                <ul className="space-y-3">
                  {displayedChecks.emotion.map((item, i) => (
                    <label
                      key={i}
                      className="text-gray-600 text-sm flex gap-3 items-start cursor-pointer hover:bg-slate-50 p-1 rounded transition-colors"
                    >
                      <input
                        type="checkbox"
                        onChange={handleCheck}
                        className="mt-1 rounded text-pink-600 focus:ring-pink-600 w-4 h-4 shrink-0 border-gray-300"
                      />
                      <span className="leading-snug">{item.text}</span>
                    </label>
                  ))}
                </ul>
              </div>

              {/* Brain */}
              <div className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:border-pink-300 transition-colors">
                <div className="flex justify-between items-center mb-3">
                  <h3 className="font-bold text-gray-800 flex items-center gap-2">
                    <Icons.Brain size={18} className="text-gray-400" /> å¤§è…¦ (Brain)
                  </h3>
                  <button
                    onClick={() => shuffleCategory("brain")}
                    className="text-xs flex items-center gap-1 text-pink-600 bg-pink-50 px-2 py-1 rounded-full hover:bg-pink-100 transition"
                  >
                    <Icons.Shuffle size={12} /> æ›ä¸€çµ„
                  </button>
                </div>
                <ul className="space-y-3">
                  {displayedChecks.brain.map((item, i) => (
                    <label
                      key={i}
                      className="text-gray-600 text-sm flex gap-3 items-start cursor-pointer hover:bg-slate-50 p-1 rounded transition-colors"
                    >
                      <input
                        type="checkbox"
                        onChange={handleCheck}
                        className="mt-1 rounded text-pink-600 focus:ring-pink-600 w-4 h-4 shrink-0 border-gray-300"
                      />
                      <span className="leading-snug">{item.text}</span>
                    </label>
                  ))}
                </ul>
              </div>
            </div>

            <button
              onClick={() => {
                setStep(4);
                handleDraw();
                window.scrollTo(0, 0);
              }}
              className={`mt-6 w-full py-4 rounded-xl font-bold text-lg shadow-lg active:scale-95 transition-transform flex items-center justify-center gap-2 mb-8
                ${
                  checkedCount === 0
                    ? "bg-pink-600 text-white"
                    : "bg-gray-900 text-white"
                }`}
            >
              <span>
                {checkedCount === 0
                  ? "ä»¥ä¸Šéƒ½æ²’æœ‰ï¼ˆå¤ªæ£’äº†ï¼ï¼‰ï¼Œç›´æ¥é ˜å–éŒ¦å›Š"
                  : `ç¢ºèª ${checkedCount} é …ç‹€æ…‹ï¼Œé ˜å–éŒ¦å›Š`}
              </span>
              <Icons.ChevronRight />
            </button>
          </div>
        );

        const renderStep4 = () => (
          <div className="flex flex-col items-center justify-center min-h-[80vh] animate-in fade-in duration-700">
            <h2 className="text-xl font-black text-gray-900 mb-6 flex items-center gap-2">
              <Icons.Shield className="text-pink-600" /> åª½å’ªç”Ÿå­˜éŒ¦å›Š
            </h2>

            {isAnimating ? (
              <div className="w-64 h-64 bg-gray-100 rounded-full flex items-center justify-center animate-bounce mb-8">
                <Icons.RefreshCw size={48} className="text-slate-400 animate-spin" />
              </div>
            ) : (
              <div className="w-full max-w-md bg-white p-8 rounded-2xl shadow-2xl border-4 border-gray-900 mb-8 relative overflow-hidden">
                <div className="absolute top-0 left-0 w-full h-3 bg-pink-600"></div>
                <div className="text-6xl mb-4 text-center">ğŸ’Š</div>
                <h3 className="text-xl font-bold text-center text-gray-800 mb-4 font-mono">
                  R<span className="text-pink-600">x</span> #
                  {Math.floor(Math.random() * 1000)}
                </h3>
                <p className="text-lg text-slate-700 leading-relaxed text-center font-bold">
                  {currentTip}
                </p>
                <div className="mt-6 pt-6 border-t border-gray-100 text-center">
                  <p className="text-xs text-slate-400">
                    é©ç”¨å°è±¡ï¼š{selectedState?.name}çš„åª½å’ª
                  </p>
                  <p className="text-xs text-slate-400 mt-1">
                    é‡å°æ€ªç¸ï¼š{selectedChild?.name}
                  </p>
                </div>
              </div>
            )}

            <div className="flex flex-col gap-3 w-full max-w-xs">
              <button
                onClick={handleShare}
                className="w-full bg-gray-800 hover:bg-gray-900 text-white py-3 rounded-xl font-bold shadow-lg transition active:translate-y-1 flex justify-center items-center gap-2"
              >
                <Icons.Share size={18} />
                <span>åˆ†äº«çµ¦æˆ°å‹</span>
              </button>

              <button
                onClick={handleDraw}
                disabled={isAnimating}
                className="w-full bg-pink-600 hover:bg-pink-700 text-white py-3 rounded-xl font-bold shadow-lg transition active:translate-y-1 disabled:opacity-50 flex justify-center items-center gap-2"
              >
                <Icons.RefreshCw size={18} />
                <span>é€™å€‹æˆ‘ä¸è¡Œï¼Œé‡æŠ½ä¸€å¼µ</span>
              </button>

              <button
                onClick={() => {
                  setStep(0);
                  setSelectedChild(null);
                  setSelectedState(null);
                  window.scrollTo(0, 0);
                }}
                className="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-bold transition flex items-center justify-center gap-2"
              >
                <Icons.Wine size={18} />
                <span>å›åˆ°é¦–é  (æˆ–å»å–é…’)</span>
              </button>
            </div>

            <p className="mt-8 text-xs text-gray-400 text-center max-w-xs leading-relaxed">
              * æœ¬éŠæˆ²ç„¡æ³•å–ä»£å°ˆæ¥­æ²»ç™‚ï¼Œä½†èƒ½æä¾›çŸ­æš«çš„é€ƒé¿èˆ‡æ­¡æ¨‚ã€‚
              <br />
              å¦³æ˜¯å¥½åª½åª½ï¼ŒçœŸçš„ã€‚
            </p>
          </div>
        );

        return (
          <div className="min-h-screen bg-gray-50 font-sans text-gray-900 selection:bg-pink-200 selection:text-pink-900">
            <div className="max-w-md mx-auto min-h-screen shadow-2xl bg-white relative overflow-hidden">
              {step > 0 && (
                <div className="h-1 bg-gray-100 w-full">
                  <div
                    className="h-full bg-pink-600 transition-all duration-500"
                    style={{ width: `${(step / 4) * 100}%` }}
                  ></div>
                </div>
              )}

              <div className="p-4">
                {step === 0 && renderWelcome()}
                {step === 1 && renderStep1()}
                {step === 2 && renderStep2()}
                {step === 3 && renderStep3()}
                {step === 4 && renderStep4()}
              </div>

              {showToast && (
                <div className="fixed bottom-8 left-1/2 -translate-x-1/2 bg-gray-900 text-white px-6 py-3 rounded-full shadow-lg z-50 animate-in fade-in slide-in-from-bottom-2">
                  ğŸ“‹ é€£çµå·²è¤‡è£½ï¼å¿«å»å‚³çµ¦å´©æ½°çš„åª½åª½æˆ°å‹å€‘ï¼
                </div>
              )}
            </div>
          </div>
        );
      }

      // å•Ÿå‹• React
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
